// Zellij Configuration
// Remapped keys to avoid conflicts with Claude Code (Ctrl+t, Ctrl+o, Ctrl+g)

pane_frames false
copy_on_select true
session_serialization true

keybinds {
    // Remap Ctrl+t (tab mode) -> Alt+t
    // Remap Ctrl+o (session mode) -> Alt+o
    // Remap Ctrl+g (lock mode) -> Alt+g
    normal {
        unbind "Ctrl o"
        // Remap default mode switches to Alt
        bind "Alt t" { SwitchToMode "tab"; }
        bind "Alt o" { SwitchToMode "session"; }
        bind "Alt g" { SwitchToMode "locked"; }
        // Override Ctrl+g/t defaults with custom actions (bind overrides, no unbind needed)
        // Ctrl+g: lazygit floating pane (fullscreen overlay, q to close)
        bind "Ctrl g" {
            Run "lazygit" {
                floating true
                close_on_exit true
                x "1%"
                y "1%"
                width "98%"
                height "96%"
            }
        }
        // Ctrl+f: sessionizer - fzf session/tab switcher
        bind "Ctrl f" {
            Run "bash" "-c" "$HOME/.config/zellij/sessionizer.sh" {
                floating true
                close_on_exit true
            }
        }
        // Ctrl+t: shell split pane on the right (exit to close)
        bind "Ctrl t" { NewPane "Right"; }
        // Alt+e: Switch to exec mode - quit session, zcc auto-restarts as zcc -e
        bind "Alt e" { Run "bash" "-c" "touch /tmp/zcc-switch-exec-$ZELLIJ_SESSION_NAME && zellij kill-session $ZELLIJ_SESSION_NAME"; }
    }
    tab {
        unbind "Ctrl t"
        bind "Alt t" { SwitchToMode "normal"; }
    }
    session {
        unbind "Ctrl o"
        bind "Alt o" { SwitchToMode "normal"; }
    }
    locked {
        unbind "Ctrl g"
        bind "Alt g" { SwitchToMode "normal"; }
    }
    // Also remap in shared contexts where these keys appear
    shared_except "normal" "locked" {
        unbind "Ctrl g"
        bind "Alt g" { SwitchToMode "locked"; }
    }
    shared_except "normal" "tab" {
        unbind "Ctrl t"
        bind "Alt t" { SwitchToMode "tab"; }
    }
    shared_except "normal" "session" {
        unbind "Ctrl o"
        bind "Alt o" { SwitchToMode "session"; }
    }
}
