{{- if .is_devcontainer }}
# Running in DevContainer
{{- else if eq .chezmoi.os "darwin" }}
# Running on macOS
{{- else if eq .chezmoi.os "linux" }}
# Running on Linux
{{- end }}

# Oh-My-Zsh initialization
export ZSH="$HOME/.oh-my-zsh"

# Load Oh-My-Zsh configuration
[[ -f "$HOME/.config/zsh/oh-my-zsh.zsh" ]] && source "$HOME/.config/zsh/oh-my-zsh.zsh"

# Load core tools configuration (fzf, direnv, z)
[[ -f "$HOME/.config/zsh/core.zsh" ]] && source "$HOME/.config/zsh/core.zsh"

{{- if eq .chezmoi.os "darwin" }}

# Load language version managers (macOS only, loads if installed)
[[ -f "$HOME/.config/zsh/tools.zsh" ]] && source "$HOME/.config/zsh/tools.zsh"
{{- end }}

# Load common functions (now, fixup)
[[ -f "$HOME/.config/zsh/functions.zsh" ]] && source "$HOME/.config/zsh/functions.zsh"

{{- if eq .chezmoi.os "darwin" }}

# Load macOS-specific functions (code)
[[ -f "$HOME/.config/zsh/functions-macos.zsh" ]] && source "$HOME/.config/zsh/functions-macos.zsh"
{{- end }}

# Load aliases
[[ -f "$HOME/.config/zsh/aliases.zsh" ]] && source "$HOME/.config/zsh/aliases.zsh"

# Load Zellij + Claude Code session management (zcc)
[[ -f "$HOME/.config/zsh/zellij.zsh" ]] && source "$HOME/.config/zsh/zellij.zsh"

{{- if eq .chezmoi.os "darwin" }}

# Load Obsidian integration (sync-plans)
[[ -f "$HOME/.config/zsh/obsidian.zsh" ]] && source "$HOME/.config/zsh/obsidian.zsh"
{{- end }}

{{- if or .is_devcontainer (eq .chezmoi.os "linux") }}

# Load Gitpod environment management (DevContainer/Linux only)
[[ -f "$HOME/.config/zsh/gitpod.zsh" ]] && source "$HOME/.config/zsh/gitpod.zsh"
{{- end }}

# Language and locale
export LANG=en_US.UTF-8
export LC_ALL=en_US.UTF-8

# Editor
{{- if .is_devcontainer }}
export EDITOR='code --wait'
{{- else }}
export EDITOR='vim'
{{- end }}
export VISUAL="$EDITOR"

# Path
export PATH="$HOME/bin:$HOME/.local/bin:$PATH"

# Local configuration (not managed by chezmoi)
[[ -f "$HOME/.zshrc.local" ]] && source "$HOME/.zshrc.local"
