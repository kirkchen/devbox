# Update prefix
unbind C-b
set -g prefix C-a

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1

set-option -g status-position top

set-option -g repeat-time 0

# Removes ESC delay
set -sg escape-time 0

# Set tmux limit
set -g history-limit 5000

# Enable mouse scroll
setw -g mouse on

# Monitor bell across all sessions (for Claude Code notifications)
set -g bell-action any
set -g visual-bell off
setw -g monitor-bell on

# Shift arrow to switch windows
bind -n S-Left  previous-window
bind -n S-Right next-window

# Order sessions by name
bind s choose-tree -sZ -O name

# Lazygit in vertical split
bind g split-window -h -l '60%' -c '#{pane_current_path}' lazygit

# Yazi file manager in vertical split
bind e split-window -h -l '60%' -c '#{pane_current_path}' yazi

# tmux-sessionx (switch between existing sessions)
set -g @sessionx-bind 'C-q'
set -g @sessionx-prefix 'off'
set -g @sessionx-zoxide-mode 'on'

# Project sessionizer (create new session from project directory)
bind p run-shell "~/.config/tmux/sessionizer.sh"

# Catppuccin theme
set -g @catppuccin_flavor 'mocha'
set -g @catppuccin_window_flags 'icon'
set -g @catppuccin_window_flags_icon_last ''
set -g @catppuccin_window_flags_icon_current ''
set -g @catppuccin_window_status_style 'basic'

# Status line (before TPM so tmux-cpu can interpolate #{cpu_percentage})
set -g status-right-length 100
set -g status-left-length 100
set -g status-left ""
set -g status-right "#[fg=#f38ba8]#(~/.config/tmux/bell-indicator.sh)#[default]#{E:@catppuccin_status_session}"
set -agF status-right "#{E:@catppuccin_status_cpu}"
set -ag status-right "#{E:@catppuccin_status_directory}"
set -ag status-right "#{E:@catppuccin_status_date_time}"

# List of plugins (catppuccin before tmux-cpu so status modules are defined,
# then tmux-cpu replaces #{cpu_percentage} in status-right)
set -g @tpm_plugins '                     \
    tmux-plugins/tpm                      \
    tmux-plugins/tmux-sensible            \
    tmux-plugins/tmux-resurrect           \
    tmux-plugins/tmux-continuum           \
    tmux-plugins/tmux-yank                \
    tmux-plugins/tmux-pain-control        \
    Morantron/tmux-fingers                \
    tmux-plugins/tmux-open                \
    catppuccin/tmux#v2.1.3                \
    tmux-plugins/tmux-cpu                 \
    omerxx/tmux-sessionx                  \
'

# Initialize TMUX plugin manager
run '~/.tmux/plugins/tpm/tpm'
