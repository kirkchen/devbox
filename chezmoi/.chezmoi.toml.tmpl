{{- /* Check Gitpod environment variables first */ -}}
{{- $envName := env "DEVBOX_USER_NAME" | default "" -}}
{{- $envEmail := env "DEVBOX_USER_EMAIL" | default "" -}}

{{- /* Use env vars if available, otherwise prompt */ -}}
{{- $name := "" -}}
{{- $email := "" -}}

{{- if $envName -}}
    {{- $name = $envName -}}
{{- else -}}
    {{- $name = promptStringOnce . "name" "What is your name" "Kirk Chen" -}}
{{- end -}}

{{- if $envEmail -}}
    {{- $email = $envEmail -}}
{{- else -}}
    {{- $email = promptStringOnce . "email" "What is your email" -}}
{{- end -}}

[data]
    # User information
    name = {{ $name | quote }}
    email = {{ $email | quote }}
    
    # System detection (automatic)
    hostname = {{ .chezmoi.hostname | quote }}
    username = {{ .chezmoi.username | quote }}
    os = {{ .chezmoi.os | quote }}
    arch = {{ .chezmoi.arch | quote }}
    
    # Environment detection
    is_macos = {{ eq .chezmoi.os "darwin" }}
    is_linux = {{ eq .chezmoi.os "linux" }}
    is_arm = {{ eq .chezmoi.arch "arm64" }}
    is_devcontainer = {{ or (env "REMOTE_CONTAINERS") (env "CODESPACES") | default false }}
    is_wsl = {{ or (env "WSL_DISTRO_NAME") (env "IS_WSL") | default false }}